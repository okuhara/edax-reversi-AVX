/**
 * @file count_last_flip_neon.c
 *
 *
 * A function is provided to count the number of fipped disc of the last move.
 *
 * The basic principle is to read into an array a precomputed result. Doing
 * this is easy for a single line ; as we can use arrays of the form:
 *  - COUNT_FLIP[square where we play][8-bits disc pattern].
 * The problem is thus to convert any line of a 64-bits disc pattern into an
 * 8-bits disc pattern. A fast way to do this is to select the right line,
 * with a bit-mask, to gather the masked-bits into a continuous set by the 
 * neon vaddvq_u16 instruction.
 * Once we get our 8-bits disc patterns, we directly get the number of
 * flipped discs from the precomputed array, and add them from each flipping
 * lines.
 * For optimization purpose, the value returned is twice the number of flipped
 * disc, to facilitate the computation of disc difference.
 *
 * @date 1998 - 2025
 * @author Richard Delorme
 * @author Toshihiko Okuhara
 * @version 4.5
 * 
 */

#include <arm_neon.h>

/** precomputed count flip array */
/** lower byte for P, upper byte for O */
static const uint16_t COUNT_FLIP[] = {
	// CF80: 0
	0x0000, 0x0000, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0c00, 0x0c00,
	0x000c, 0x000c, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0000, 0x0000,
	// CF81: 256
	0x0000, 0x0000, 0x0000, 0x0000, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0800, 0x0800, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0008, 0x0008, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0a00, 0x0a00, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x000a, 0x000a, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0800, 0x0800, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0008, 0x0008, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0000, 0x0000, 0x0000, 0x0000,
	// CF82: 512
	0x0000, 0x0002, 0x0200, 0x0000, 0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600, 0x0600, 0x0602, 0x0800, 0x0600,
	0x0006, 0x0008, 0x0206, 0x0006, 0x0006, 0x0008, 0x0206, 0x0006,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0800, 0x0802, 0x0a00, 0x0800, 0x0800, 0x0802, 0x0a00, 0x0800,
	0x0008, 0x000a, 0x0208, 0x0008, 0x0008, 0x000a, 0x0208, 0x0008,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600, 0x0600, 0x0602, 0x0800, 0x0600,
	0x0006, 0x0008, 0x0206, 0x0006, 0x0006, 0x0008, 0x0206, 0x0006,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0000, 0x0002, 0x0200, 0x0000, 0x0000, 0x0002, 0x0200, 0x0000,
	// CF83: 768
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0600, 0x0604, 0x0602, 0x0602, 0x0800, 0x0800, 0x0a00, 0x0600,
	0x0600, 0x0604, 0x0602, 0x0602, 0x0800, 0x0800, 0x0a00, 0x0600,
	0x0006, 0x000a, 0x0008, 0x0008, 0x0206, 0x0206, 0x0406, 0x0006,
	0x0006, 0x000a, 0x0008, 0x0008, 0x0206, 0x0206, 0x0406, 0x0006,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	// CF84: 1024
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0400, 0x0406, 0x0404, 0x0404, 0x0402, 0x0402, 0x0402, 0x0402,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0400,
	0x0400, 0x0406, 0x0404, 0x0404, 0x0402, 0x0402, 0x0402, 0x0402,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0400,
	0x0004, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0204, 0x0204, 0x0204, 0x0204, 0x0404, 0x0404, 0x0604, 0x0004,
	0x0004, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0204, 0x0204, 0x0204, 0x0204, 0x0404, 0x0404, 0x0604, 0x0004,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	// CF85: 1280
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0200, 0x0208, 0x0206, 0x0206, 0x0204, 0x0204, 0x0204, 0x0204,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0200,
	0x0200, 0x0208, 0x0206, 0x0206, 0x0204, 0x0204, 0x0204, 0x0204,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0200,
	0x0002, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0402, 0x0402, 0x0402, 0x0402, 0x0602, 0x0602, 0x0802, 0x0002,
	0x0002, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0402, 0x0402, 0x0402, 0x0402, 0x0602, 0x0602, 0x0802, 0x0002,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	// CF86: 1536
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	// CF87: 1792
	0x0000, 0x000c, 0x000a, 0x000a, 0x0008, 0x0008, 0x0008, 0x0008,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0800, 0x0800, 0x0800, 0x0800, 0x0a00, 0x0a00, 0x0c00, 0x0000,
	0x0000, 0x000c, 0x000a, 0x000a, 0x0008, 0x0008, 0x0008, 0x0008,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0800, 0x0800, 0x0800, 0x0800, 0x0a00, 0x0a00, 0x0c00, 0x0000,

	// for shorter diagonal lines (interleaved), * = pos = 0
	// RF70: 2048 (.bbbbbb*)
	         // LF74: 2049 (bb*bbbb.)
	0x0000,  0x0000,      0x0200,  0x0006,      0x0002,  0x0004,      0x0400,  0x0004,
	0x0004,  0x0002,      0x0200,  0x0002,      0x0002,  0x0002,      0x0600,  0x0002,
	0x0006,  0x0200,      0x0200,  0x0200,      0x0002,  0x0200,      0x0400,  0x0200,
	0x0004,  0x0400,      0x0200,  0x0400,      0x0002,  0x0600,      0x0800,  0x0000,
	             // LF63: 2081 (bb*bbb..)                                          // LF41 (bb*0....)
	                                   // LF52: 2083 (bb*bb...)                    // LF30 (bb*.....)
	0x0008,      0x0000,  0x0200,      0x0000,  0x0002,      0x0004,  0x0400,      0x0000,
	0x0004,      0x0002,  0x0200,      0x0002,  0x0002,      0x0002,  0x0600,      0x0000,
	0x0006,      0x0200,  0x0200,      0x0200,  0x0002,      0x0200,  0x0400,      0x0000,
	0x0004,      0x0400,  0x0200,      0x0000,  0x0002,      0x0000,  0x0a00,      0,
	0x000a,  0x0200,      0x0200,  0x0206,      0x0002,  0x0204,      0x0400,  0x0204,
	0x0004,  0x0202,      0x0200,  0x0202,      0x0002,  0x0202,      0x0600,  0x0202,
	0x0006,  0x0400,      0x0200,  0x0400,      0x0002,  0x0400,      0x0400,  0x0400,
	0x0004,  0x0600,      0x0200,  0x0600,      0x0002,  0x0800,      0x0800,  0x0200,
	0x0008,      0x0200,  0x0200,      0x0200,  0x0002,      0x0204,  0x0400,      0x0200,
	0x0004,      0x0202,  0x0200,      0x0202,  0x0002,      0x0202,  0x0600,      0x0200,
	0x0006,      0x0400,  0x0200,      0x0400,  0x0002,      0x0400,  0x0400,      0x0200,
	0x0004,      0x0600,  0x0200,      0x0200,  0x0002,      0x0200,  0x0000,      0,
	// RF71: 2176 (.bbbbb*0)
	                      // RF61: 2178 (..bbbb*0)
	0x0000,  0x0002,      0x0000,  0x0008,      0x0200,  0x0006,      0x0200,  0x0006,
	0x0002,  0x0004,      0x0002,  0x0004,      0x0400,  0x0004,      0x0400,  0x0004,
	0x0004,  0x0202,      0x0004,  0x0202,      0x0200,  0x0202,      0x0200,  0x0202,
	0x0002,  0x0402,      0x0002,  0x0402,      0x0600,  0x0602,      0x0600,  0x0002,
	0x0006,      0x0002,  0x0006,      0x0002,  0x0200,      0x0006,  0x0200,      0x0002,
	0x0002,      0x0004,  0x0002,      0x0004,  0x0400,      0x0004,  0x0400,      0x0002,
	0x0004,      0x0202,  0x0004,      0x0202,  0x0200,      0x0202,  0x0200,      0x0002,
	0x0002,      0x0402,  0x0002,      0x0002,  0x0800,      0x0002,  0x0000,      0,
	                      // RF51: 2242 (...bbb*0)
	0x0008,  0x0000,      0x0000,  0x0006,      0x0200,  0x0004,      0x0200,  0x0004,
	0x0002,  0x0002,      0x0002,  0x0002,      0x0400,  0x0002,      0x0400,  0x0002,
	0x0004,  0x0200,      0x0004,  0x0200,      0x0200,  0x0200,      0x0200,  0x0200,
	0x0002,  0x0400,      0x0002,  0x0400,      0x0600,  0x0600,      0x0000,  0x0000,
	                      // RF41: 2274 (....bb*0)
	0x0006,      0x0000,  0x0000,      0x0000,  0x0200,      0x0004,  0x0200,      0x0000,
	0x0002,      0x0002,  0x0002,      0x0002,  0x0400,      0x0002,  0x0000,      0x0000,
	                      // RF31 (.....0*0)
	0x0004,      0x0200,  0x0000,      0x0200,  0x0200,      0x0200,  0x0000,      0x0000,
	0x0002,      0x0400,  0,           0x0000,  0x0000,      0x0000,  0,           0,

	// RF60: 2304 (..bbbbb*)
	         // RF50: 2305 (...bbbb*)
	0x0000,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0600,  0x0600,
	0x0006,  0x0006,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0800,  0x0000,
	         // RF40: 2337 (....bbb*)
	0x0008,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0600,  0x0000,
	         // RF30: 2353 (.....bb*)
	0x0006,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0000,
	0x0004,  0,       0x0200,  0,       0x0002,  0,       0x0000,  0,

	// RF72: 2368 (.bbbb*bb)         // RF62: 2372 (..bbb*bb)
	0x0000, 0x0002, 0x0200, 0x0000,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400,  0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004,  0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF52: 2436 (...bb*bb)
	0x0006, 0x0008, 0x0206, 0x0006,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF42 (....0*bb)
	0x0004, 0x0006, 0x0204, 0x0004,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF32 (.....*bb)
	0x0002, 0x0004, 0x0202, 0x0002,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0000, 0x0002, 0x0200, 0x0000,  0, 0, 0, 0,

	// LF72: 2496 (bbbb*bb.)
	         // LF61 (bbbb*0..)
	                           // LF50 (bbbb*...)
	0x0000,  0x0000,  0x0002,  0x0000,  0x0200,  0x0000,  0x0000,  0,
	    // RF73: 2504 (.bbb*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0400,  0x0400,  0x0402,  0x0400,  0x0600,  0x0400,  0x0400,  0,
	    0x0400,  0x0404,  0x0402,  0x0402,  0x0600,  0x0600,  0x0800,  0x0400,
	0x0004,  0x0004,  0x0006,  0x0004,  0x0204,  0x0004,  0x0004,  0,
	    0x0004,  0x0008,  0x0006,  0x0006,  0x0204,  0x0204,  0x0404,  0x0004,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0600,  0x0600,  0x0602,  0x0600,  0x0800,  0x0600,  0x0600,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0006,  0x0006,  0x0008,  0x0006,  0x0206,  0x0006,  0x0006,  0,
	    // RF63: 2632 (..bb*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0400,  0x0400,  0x0402,  0x0400,  0x0600,  0x0400,  0x0400,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0004,  0x0004,  0x0006,  0x0004,  0x0204,  0x0004,  0x0004,  0,
	    // RF53 (...0*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    // RF43 (....*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0000,  0x0000,  0x0002,  0x0000,  0x0200,  0x0000,  0x0000,  0,

	// LF73: 2744 (bbb*bbb.)
	         // LF62: 2745 (bbb*bb..)
	                           // LF51 (bbb*0...)                  // LF40 (bbb*....)
	0x0000,  0x0000,  0x0004,  0x0000,  0x0002,  0x0002,  0x0002,  0x0000,
	0x0200,  0x0200,  0x0200,  0x0000,  0x0400,  0x0000,  0x0000,  0,
	    // RF74: 2760 (.bb*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0200,  0x0200,  0x0204,  0x0200,  0x0202,  0x0202,  0x0202,  0x0200,
	0x0400,  0x0400,  0x0400,  0x0200,  0x0600,  0x0200,  0x0200,  0,
	    0x0200,  0x0206,  0x0204,  0x0204,  0x0202,  0x0202,  0x0202,  0x0202,
	    0x0400,  0x0400,  0x0400,  0x0400,  0x0600,  0x0600,  0x0800,  0x0200,
	0x0002,  0x0002,  0x0006,  0x0002,  0x0004,  0x0004,  0x0004,  0x0002,
	0x0202,  0x0202,  0x0202,  0x0002,  0x0402,  0x0002,  0x0002,  0,
	    0x0002,  0x0008,  0x0006,  0x0006,  0x0004,  0x0004,  0x0004,  0x0004,
	    0x0202,  0x0202,  0x0202,  0x0202,  0x0402,  0x0402,  0x0602,  0x0002,
	0x0400,  0x0400,  0x0404,  0x0400,  0x0402,  0x0402,  0x0402,  0x0400,
	0x0600,  0x0600,  0x0600,  0x0400,  0x0800,  0x0400,  0x0400,  0,
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0004,  0x0004,  0x0008,  0x0004,  0x0006,  0x0006,  0x0006,  0x0004,
	0x0204,  0x0204,  0x0204,  0x0004,  0x0404,  0x0004,  0x0004,  0,
	    // RF64 (...0*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0200,  0x0200,  0x0204,  0x0200,  0x0202,  0x0202,  0x0202,  0x0200,
	0x0400,  0x0400,  0x0400,  0x0200,  0x0600,  0x0200,  0x0200,  0,
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0002,  0x0002,  0x0006,  0x0002,  0x0004,  0x0004,  0x0004,  0x0002,
	0x0202,  0x0202,  0x0202,  0x0002,  0x0402,  0x0002,  0x0002,  0,
	    // RF54 (....*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0000,  0x0000,  0x0004,  0x0000,  0x0002,  0x0002,  0x0002,  0x0000,
	0x0200,  0x0200,  0x0200,  0x0000,  0x0400,  0x0000,  0x0000,  0,

	// LF75: 2984 (0*bbbbb.)
	         // LF64: 2985 (0*bbbb..)                              // LF42: 2991 (0*bb....)
	                           // LF53:2987 (0*bbb...)             // LF31 (0*0.....)
	0x0000,  0x0000,  0x0008,  0x0000,  0x0006,  0x0006,  0x0006,  0x0000,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0000,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0000,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0000,
	0x0600,  0x0600,  0x0600,  0x0000,  0x0800,  0x0000,  0x0000,  0,

	// LF76: 3048 (*bbbbbb.)
	         // LF65: 3049 (*bbbbb..)                              // LF43: 3055 (*bbb....)
	                           // LF54: 3051 (*bbbb...)            // LF32: 3063 (*bb.....)
	0x0000,  0x0000,  0x000a,  0x0000,  0x0008,  0x0008,  0x0008,  0x0000,
	0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0000,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0000,
	0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0000,
	0x0800,  0x0800,  0x0800,  0x0000,  0x0a00,  0x0000,  0x0000,  0,
};	// 3176

enum {
	CF80 =    0, CF81 =  256, CF82 =  512, CF83 =  768, CF84 = 1024, CF85 = 1280, CF86 = 1536, CF87 = 1792,
	RF70 = 2048, RF71 = 2176, RF72 = 2368, RF73 = 2504, RF74 = 2760,
	RF60 = 2304, RF61 = 2178, RF62 = 2372, RF63 = 2632,
	RF50 = 2305, RF51 = 2242, RF52 = 2436,
	RF40 = 2337, RF41 = 2274,
	RF30 = 2353,
	LF72 = 2496, LF73 = 2744, LF74 = 2049, LF75 = 2984, LF76 = 3048,
	LF62 = 2745, LF63 = 2081, LF64 = 2985, LF65 = 3049,
	LF52 = 2083, LF53 = 2987, LF54 = 3051,
	LF42 = 2991, LF43 = 3055,
	LF32 = 3063
};

#ifdef HAS_CPU_64
/* bit masks for diagonal lines (interleaved) */
static const uint64x2_t mask_dvhd[64][2] = {
	{{ 0x000000000000ff00, 0x0000000000000000 }, { 0x0801040102010101, 0x8001400120011001 }},
	{{ 0x000000000000ff00, 0x0000000000000000 }, { 0x1002080204020002, 0x0002800240022002 }},
	{{ 0x000000010002ff00, 0x0000000000000000 }, { 0x2004100408040004, 0x0004000480044004 }},
	{{ 0x000100020004ff00, 0x0000000000000000 }, { 0x4008200810080008, 0x0008000800088008 }},
	{{ 0x000200040008ff00, 0x0000000000000001 }, { 0x8010401020100010, 0x0010001000100010 }},
	{{ 0x000400080010ff00, 0x0000000000010002 }, { 0x0020802040200020, 0x0020002000200020 }},
	{{ 0x000800100020ff00, 0x0000000100020004 }, { 0x0040004000400040, 0x0040004000400040 }},
	{{ 0x001000200040ff80, 0x0001000200040008 }, { 0x0080008000800080, 0x0080008000800080 }},
	{{ 0x00000000ff000000, 0x0000000000000000 }, { 0x0401020100010001, 0x4001200110010801 }},
	{{ 0x00000000ff000000, 0x0000000000000000 }, { 0x0802040202020102, 0x8002400220021002 }},
	{{ 0x00010002ff000000, 0x0000000000000000 }, { 0x1004080400040004, 0x0004800440042004 }},
	{{ 0x00020004ff000000, 0x0000000000000001 }, { 0x2008100800080008, 0x0008000880084008 }},
	{{ 0x00040008ff000000, 0x0000000000010002 }, { 0x4010201000100010, 0x0010001000108010 }},
	{{ 0x00080010ff000000, 0x0000000100020004 }, { 0x8020402000200020, 0x0020002000200020 }},
	{{ 0x00100020ff400080, 0x0001000200040008 }, { 0x0040004000400040, 0x0040004000400040 }},
	{{ 0x00200040ff000000, 0x0002000400080010 }, { 0x0080008000800080, 0x0080008000800080 }},
	{{ 0x0000ff0000020004, 0x0000000000000000 }, { 0x0201000100010001, 0x2001100108010401 }},
	{{ 0x0000ff0000040008, 0x0000000000000000 }, { 0x0402000200020002, 0x4002200210020802 }},
	{{ 0x0002ff0000080010, 0x0000000000000001 }, { 0x0804040402040104, 0x8004400420041004 }},
	{{ 0x0004ff0000100020, 0x0000000000010002 }, { 0x1008000804080208, 0x0008800840082008 }},
	{{ 0x0008ff0000200040, 0x0000000100020004 }, { 0x2010001008100410, 0x0010001080104010 }},
	{{ 0x0010ff2000400080, 0x0001000200040008 }, { 0x4020002010200820, 0x0020002000208020 }},
	{{ 0x0020ff0000000000, 0x0002000400080010 }, { 0x0040004020401040, 0x0040004000400040 }},
	{{ 0x0040ff0000000000, 0x0004000800100020 }, { 0x0080008040802080, 0x0080008000800080 }},
	{{ 0xff00000200040008, 0x0000000000000000 }, { 0x0001000100010001, 0x1001080104010201 }},
	{{ 0xff00000400080010, 0x0000000000000000 }, { 0x0002000200020002, 0x2002100208020402 }},
	{{ 0xff00000800100020, 0x0000000000010002 }, { 0x0004020401040004, 0x4004200410040804 }},
	{{ 0xff00001000200040, 0x0000000100020004 }, { 0x0808040802080108, 0x8008400820081008 }},
	{{ 0xff10002000400080, 0x0001000200040008 }, { 0x0010081004100210, 0x0010801040102010 }},
	{{ 0xff00004000800000, 0x0002000400080010 }, { 0x0020102008200420, 0x0020002080204020 }},
	{{ 0xff00000000000000, 0x0004000800100020 }, { 0x0040204010400840, 0x0040004000400040 }},
	{{ 0xff00000000000000, 0x0008001000200040 }, { 0x0080408020801080, 0x0080008000800080 }},
	{{ 0x0002000400080010, 0x000000000000ff00 }, { 0x0001000100010001, 0x0801040102010001 }},
	{{ 0x0004000800100020, 0x000000000000ff00 }, { 0x0002000200020002, 0x1002080204020002 }},
	{{ 0x0008001000200040, 0x000000010002ff00 }, { 0x0204010400040004, 0x2004100408040004 }},
	{{ 0x0010002000400080, 0x000100020004ff08 }, { 0x0408020801080008, 0x4008200810080008 }},
	{{ 0x0020004000800000, 0x000200040008ff00 }, { 0x0810041002100110, 0x8010401020101010 }},
	{{ 0x0040008000000000, 0x000400080010ff00 }, { 0x1020082004200220, 0x0020802040200020 }},
	{{ 0x0000000000000000, 0x000800100020ff00 }, { 0x2040104008400440, 0x0040004000400040 }},
	{{ 0x0000000000000000, 0x001000200040ff00 }, { 0x4080208010800880, 0x0080008000800080 }},
	{{ 0x0004000800100020, 0x00000000ff000002 }, { 0x0001000100010001, 0x0401020100010001 }},
	{{ 0x0008001000200040, 0x00000000ff000004 }, { 0x0002000200020002, 0x0802040200020002 }},
	{{ 0x0010002000400080, 0x00010002ff040008 }, { 0x0104000400040004, 0x1004080400040204 }},
	{{ 0x0020004000800000, 0x00020004ff000010 }, { 0x0208010800080008, 0x2008100800080408 }},
	{{ 0x0040008000000000, 0x00040008ff000020 }, { 0x0410021001100010, 0x4010201000100810 }},
	{{ 0x0080000000000000, 0x00080010ff000040 }, { 0x0820042002200120, 0x8020402020201020 }},
	{{ 0x0000000000000000, 0x00100020ff000000 }, { 0x1040084004400240, 0x0040004000402040 }},
	{{ 0x0000000000000000, 0x00200040ff000000 }, { 0x2080108008800480, 0x0080008000804080 }},
	{{ 0x0008001000200040, 0x0000ff0000020004 }, { 0x0001000100010001, 0x0001000100010001 }},
	{{ 0x0010002000400080, 0x0001ff0200040008 }, { 0x0002000200020002, 0x0002000200020002 }},
	{{ 0x0020004000800000, 0x0000ff0000080010 }, { 0x0004000400040004, 0x0004000402040104 }},
	{{ 0x0040008000000000, 0x0000ff0000100020 }, { 0x0108000800080008, 0x0008000804080208 }},
	{{ 0x0080000000000000, 0x0000ff0000200040 }, { 0x0210011000100010, 0x0010001008100410 }},
	{{ 0x0000000000000000, 0x0000ff0000400080 }, { 0x0420022001200020, 0x0020002010200820 }},
	{{ 0x0000000000000000, 0x0000ff0000000000 }, { 0x0840044002400140, 0x8040404020401040 }},
	{{ 0x0000000000000000, 0x0000ff0000000000 }, { 0x1080088004800280, 0x0080008040802080 }},
	{{ 0x0010002000400080, 0xff01000200040008 }, { 0x0001000100010001, 0x0001000100010001 }},
	{{ 0x0020004000800000, 0xff00000400080010 }, { 0x0002000200020002, 0x0002000200020002 }},
	{{ 0x0040008000000000, 0xff00000800100020 }, { 0x0004000400040004, 0x0004020401040004 }},
	{{ 0x0080000000000000, 0xff00001000200040 }, { 0x0008000800080008, 0x0008040802080108 }},
	{{ 0x0000000000000000, 0xff00002000400080 }, { 0x0110001000100010, 0x0010081004100210 }},
	{{ 0x0000000000000000, 0xff00004000800000 }, { 0x0220012000200020, 0x0020102008200420 }},
	{{ 0x0000000000000000, 0xff00000000000000 }, { 0x0440024001400040, 0x0040204010400840 }},
	{{ 0x0000000000000000, 0xff00000000000000 }, { 0x0880048002800180, 0x8080408020801080 }}
};
#else
/* bit masks for diagonal lines */
static const uint64x2_t mask_dvhd[64][2] = {
	{{ 0x0000000000000000, 0x00000000000000ff }, { 0x0101010101010101, 0x8040201008040201 }},
	{{ 0x0000000000000000, 0x00000000000000ff }, { 0x0202020202020202, 0x0080402010080400 }},
	{{ 0x0000000000010200, 0x00000000000000ff }, { 0x0404040404040404, 0x0000804020100800 }},
	{{ 0x0000000001020400, 0x00000000000000ff }, { 0x0808080808080808, 0x0000008040201000 }},
	{{ 0x0000000102040800, 0x00000000000000ff }, { 0x1010101010101010, 0x0000000080402000 }},
	{{ 0x0000010204081000, 0x00000000000000ff }, { 0x2020202020202020, 0x0000000000804000 }},
	{{ 0x0001020408102000, 0x00000000000000ff }, { 0x4040404040404040, 0x0000000000000000 }},
	{{ 0x0102040810204080, 0x00000000000000ff }, { 0x8080808080808080, 0x0000000000000000 }},
	{{ 0x0000000000000000, 0x000000000000ff00 }, { 0x0101010101010101, 0x4020100804020000 }},
	{{ 0x0000000000000000, 0x000000000000ff00 }, { 0x0202020202020202, 0x8040201008040201 }},	// RF31 -> 0
	{{ 0x0000000001020000, 0x000000000000ff00 }, { 0x0404040404040404, 0x0080402010080000 }},	// RF42 -> RF32
	{{ 0x0000000102040000, 0x000000000000ff00 }, { 0x0808080808080808, 0x0000804020100000 }},	// RF53 -> RF43
	{{ 0x0000010204080000, 0x000000000000ff00 }, { 0x1010101010101010, 0x0000008040200000 }},	// RF64 -> RF54
	{{ 0x0001020408100000, 0x000000000000ff00 }, { 0x2020202020202020, 0x0000000080400000 }},	// RF75 -> RF65
	{{ 0x0102040810204080, 0x000000000000ff00 }, { 0x4040404040404040, 0x0000000000000000 }},	// RF31 -> 0
	{{ 0x0204081020400000, 0x000000000000ff00 }, { 0x8080808080808080, 0x0000000000000000 }},
	{{ 0x0000000000000204, 0x0000000000ff0000 }, { 0x0101010101010101, 0x2010080402000000 }},
	{{ 0x0000000000000408, 0x0000000000ff0000 }, { 0x0202020202020202, 0x4020100804000000 }},	// RF42 -> RF32	// LF71 -> LF60
	{{ 0x0000000102000810, 0x0000000000ff0000 }, { 0x0404040404040404, 0x8040201008040201 }},
	{{ 0x0000010204001020, 0x0000000000ff0000 }, { 0x0808080808080808, 0x0080402010000402 }},
	{{ 0x0001020408002040, 0x0000000000ff0000 }, { 0x1010101010101010, 0x0000804020000804 }},
	{{ 0x0102040810204080, 0x0000000000ff0000 }, { 0x2020202020202020, 0x0000008040001008 }},
	{{ 0x0204081020000000, 0x0000000000ff0000 }, { 0x4040404040404040, 0x0000000000002010 }},	// LF71 -> LF60	// RF42 -> RF32
	{{ 0x0408102040000000, 0x0000000000ff0000 }, { 0x8080808080808080, 0x0000000000004020 }},
	{{ 0x0000000000020408, 0x00000000ff000000 }, { 0x0101010101010101, 0x1008040200000000 }},
	{{ 0x0000000000040810, 0x00000000ff000000 }, { 0x0202020202020202, 0x2010080400000000 }},	// RF53 -> RF43	// LF61 -> LF50
	{{ 0x0000010200081020, 0x00000000ff000000 }, { 0x0404040404040404, 0x4020100800020100 }},
	{{ 0x0001020400102040, 0x00000000ff000000 }, { 0x0808080808080808, 0x8040201008040201 }},
	{{ 0x0102040810204080, 0x00000000ff000000 }, { 0x1010101010101010, 0x0080402000080402 }},
	{{ 0x0204081000408000, 0x00000000ff000000 }, { 0x2020202020202020, 0x0000804000100804 }},
	{{ 0x0408102000000000, 0x00000000ff000000 }, { 0x4040404040404040, 0x0000000000201008 }},	// LF61 -> LF50	// RF53 -> RF43
	{{ 0x0810204000000000, 0x00000000ff000000 }, { 0x8080808080808080, 0x0000000000402010 }},
	{{ 0x0000000002040810, 0x000000ff00000000 }, { 0x0101010101010101, 0x0804020000000000 }},
	{{ 0x0000000004081020, 0x000000ff00000000 }, { 0x0202020202020202, 0x1008040000000000 }},	// RF64 -> RF54	// LF51 -> LF40
	{{ 0x0001020008102040, 0x000000ff00000000 }, { 0x0404040404040404, 0x2010080002010000 }},
	{{ 0x0102040810204080, 0x000000ff00000000 }, { 0x0808080808080808, 0x4020100004020100 }},
	{{ 0x0204080020408000, 0x000000ff00000000 }, { 0x1010101010101010, 0x8040201008040201 }},
	{{ 0x0408100040800000, 0x000000ff00000000 }, { 0x2020202020202020, 0x0080400010080402 }},
	{{ 0x0810200000000000, 0x000000ff00000000 }, { 0x4040404040404040, 0x0000000020100804 }},	// LF51 -> LF40	// RF64 -> RF54
	{{ 0x1020400000000000, 0x000000ff00000000 }, { 0x8080808080808080, 0x0000000040201008 }},
	{{ 0x0000000204081020, 0x0000ff0000000000 }, { 0x0101010101010101, 0x0402000000000000 }},
	{{ 0x0000000408102040, 0x0000ff0000000000 }, { 0x0202020202020202, 0x0804000000000000 }},	// RF75 -> RF65	// LF41 -> LF30
	{{ 0x0102040810204080, 0x0000ff0000000000 }, { 0x0404040404040404, 0x1008000201000000 }},
	{{ 0x0204001020408000, 0x0000ff0000000000 }, { 0x0808080808080808, 0x2010000402010000 }},
	{{ 0x0408002040800000, 0x0000ff0000000000 }, { 0x1010101010101010, 0x4020000804020100 }},
	{{ 0x0810004080000000, 0x0000ff0000000000 }, { 0x2020202020202020, 0x8040201008040201 }},
	{{ 0x1020000000000000, 0x0000ff0000000000 }, { 0x4040404040404040, 0x0000002010080402 }},	// LF41 -> LF30	// RF75 -> RF65
	{{ 0x2040000000000000, 0x0000ff0000000000 }, { 0x8080808080808080, 0x0000004020100804 }},
	{{ 0x0000020408102040, 0x00ff000000000000 }, { 0x0101010101010101, 0x0000000000000000 }},
	{{ 0x0102040810204080, 0x00ff000000000000 }, { 0x0202020202020202, 0x0000000000000000 }},
	{{ 0x0000081020408000, 0x00ff000000000000 }, { 0x0404040404040404, 0x0000020100000000 }},	// LF71 -> LF60
	{{ 0x0000102040800000, 0x00ff000000000000 }, { 0x0808080808080808, 0x0000040201000000 }},	// LF61 -> LF50
	{{ 0x0000204080000000, 0x00ff000000000000 }, { 0x1010101010101010, 0x0000080402010000 }},	// LF51 -> LF40
	{{ 0x0000408000000000, 0x00ff000000000000 }, { 0x2020202020202020, 0x0000100804020100 }},	// LF41 -> LF30
	{{ 0x0000000000000000, 0x00ff000000000000 }, { 0x4040404040404040, 0x8040201008040201 }},	// LF31->0
	{{ 0x0000000000000000, 0x00ff000000000000 }, { 0x8080808080808080, 0x0000402010080402 }},
	{{ 0x0102040810204080, 0xff00000000000000 }, { 0x0101010101010101, 0x0000000000000000 }},
	{{ 0x0004081020408000, 0xff00000000000000 }, { 0x0202020202020202, 0x0000000000000000 }},
	{{ 0x0008102040800000, 0xff00000000000000 }, { 0x0404040404040404, 0x0002010000000000 }},
	{{ 0x0010204080000000, 0xff00000000000000 }, { 0x0808080808080808, 0x0004020100000000 }},
	{{ 0x0020408000000000, 0xff00000000000000 }, { 0x1010101010101010, 0x0008040201000000 }},
	{{ 0x0040800000000000, 0xff00000000000000 }, { 0x2020202020202020, 0x0010080402010000 }},
	{{ 0x0000000000000000, 0xff00000000000000 }, { 0x4040404040404040, 0x0020100804020100 }},
	{{ 0x0000000000000000, 0xff00000000000000 }, { 0x8080808080808080, 0x8040201008040201 }}
};
#endif

/**
 * Count last flipped discs when playing on the last empty.
 *
 * @param pos the last empty square.
 * @param P player's disc pattern.
 * @return flipped disc count.
 */

#ifndef HAS_CPU_64
	#define vaddv_u8(x)	vget_lane_u32(vreinterpret_u32_u64(vpaddl_u32(vpaddl_u16(vpaddl_u8(x)))), 0)
#endif

int last_flip(int pos, unsigned long long P)
{
	uint_fast8_t n_flips;
	const uint16_t *COUNT_FLIP_X = COUNT_FLIP + (pos & 7) * 256;
	const uint16_t *COUNT_FLIP_Y = COUNT_FLIP + (pos >> 3) * 256;
	uint64x2_t PP = vdupq_n_u64(P);
	uint64x2_t II;
#ifdef HAS_CPU_64	// vaddvq
	unsigned int t;
	const uint64x2_t dmask = { 0x0808040402020101, 0x8080404020201010 };

	PP = vreinterpretq_u64_u8(vzip1q_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(PP)));
	t = vaddvq_u16(vreinterpretq_u16_u64(vandq_u64(PP, mask_dvhd[pos][0])));	// 2 dirs interleaved
	n_flips  = (uint8_t) COUNT_FLIP_X[t & 0xFF];
	n_flips += (uint8_t) COUNT_FLIP_X[t >> 8];
	II = vandq_u64(vreinterpretq_u64_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1]))), dmask);
	t = vaddvq_u16(vreinterpretq_u16_u64(II));
	n_flips += (uint8_t) COUNT_FLIP_Y[t & 0xFF];
	n_flips += (uint8_t) COUNT_FLIP_Y[t >> 8];

#else // Neon kindergarten
	const uint32x4_t dmask = { 0x01020408, 0x10204080, 0x01020408, 0x10204080 };

	II = vpaddlq_u32(vpaddlq_u16(vpaddlq_u8(vreinterpretq_u8_u64(vandq_u64(PP, mask_dvhd[pos][0])))));
	n_flips  = (uint8_t) COUNT_FLIP_X[vgetq_lane_u32(vreinterpretq_u32_u64(II), 0)];
	n_flips += (uint8_t) COUNT_FLIP_X[vgetq_lane_u32(vreinterpretq_u32_u64(II), 2)];
	II = vreinterpretq_u64_s8(vnegq_s8(vreinterpretq_s8_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1])))));
	II = vpaddlq_u32(vmulq_u32(dmask, vreinterpretq_u32_u64(II)));
	n_flips += (uint8_t) COUNT_FLIP_Y[vgetq_lane_u8(vreinterpretq_u8_u64(II), 3)];
	n_flips += (uint8_t) COUNT_FLIP_Y[vgetq_lane_u8(vreinterpretq_u8_u64(II), 11)];
#endif
	return n_flips;
}

/**
 * @brief Get the final score.
 *
 * Get the final score, when 1 empty square remain.
 * The following code has been adapted from Zebra by Gunnar Anderson.
 *
 * @param P      Board.player to evaluate.
 * @param alpha  Alpha bound. (beta - 1)
 * @param pos    Last empty square to play.
 * @return       The final score, as a disc difference.
 */
#ifdef LASTFLIP_LOWCUT
// Old COUNT_LAST_FLIP_NEON
int mm_solve_1(uint64x1_t P, int alpha, int pos)
{
	int score = 2 * vaddv_u8(vcnt_u8(vreinterpret_u8_u64(P))) - SCORE_MAX + 2;	// = (bit_count(P) + 1) - (SCORE_MAX - 1 - bit_count(P))
	unsigned int t0, t1;
	uint_fast8_t n_flips;
	uint_fast16_t op_flip, m;
	const uint16_t *COUNT_FLIP_X = COUNT_FLIP + (pos & 7) * 256;
	const uint16_t *COUNT_FLIP_Y = COUNT_FLIP + (pos >> 3) * 256;
	uint64x2_t PP = vdupq_lane_u64(P, 0);
	uint64x2_t II;
	static const uint16_t o_mask[64] = {
		0xff01, 0x7f03, 0x3f07, 0x1f0f, 0x0f1f, 0x073f, 0x037f, 0x01ff,
		0xfe03, 0xff07, 0x7f0f, 0x3f1f, 0x1f3f, 0x0f7f, 0x07ff, 0x03fe,
		0xfc07, 0xfe0f, 0xff1f, 0x7f3f, 0x3f7f, 0x1fff, 0x0ffe, 0x07fc,
		0xf80f, 0xfc1f, 0xfe3f, 0xff7f, 0x7fff, 0x3ffe, 0x1ffc, 0x0ff8,
		0xf01f, 0xf83f, 0xfc7f, 0xfeff, 0xfffe, 0x7ffc, 0x3ff8, 0x1ff0,
		0xe03f, 0xf07f, 0xf8ff, 0xfcfe, 0xfefc, 0xfff8, 0x7ff0, 0x3fe0,
		0xc07f, 0xe0ff, 0xf0fe, 0xf8fc, 0xfcf8, 0xfef0, 0xffe0, 0x7fc0,
		0x80ff, 0xc0fe, 0xe0fc, 0xf0f8, 0xf8f0, 0xfce0, 0xfec0, 0xff80
	};
  #ifdef HAS_CPU_64	// vaddvq
	const uint64x2_t dmask = { 0x0808040402020101, 0x8080404020201010 };

	PP = vreinterpretq_u64_u8(vzip1q_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(PP)));
	t0 = vaddvq_u16(vreinterpretq_u16_u64(vandq_u64(PP, mask_dvhd[pos][0])));	// 2 dirs interleaved
	n_flips  = (uint8_t) COUNT_FLIP_X[t0 & 0xFF];
	op_flip  = COUNT_FLIP_X[t0 >> 8];
	II = vandq_u64(vreinterpretq_u64_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1]))), dmask);
	t1 = vaddvq_u16(vreinterpretq_u16_u64(II));
	op_flip += COUNT_FLIP_Y[t1 & 0xFF];
	n_flips += (uint8_t) COUNT_FLIP_Y[t1 >>= 8];

  #else // Neon kindergarten
	const uint32x4_t dmask = { 0x01020408, 0x10204080, 0x01020408, 0x10204080 };

	II = vpaddlq_u32(vpaddlq_u16(vpaddlq_u8(vreinterpretq_u8_u64(vandq_u64(PP, mask_dvhd[pos][0])))));
	n_flips  = (uint8_t) COUNT_FLIP_X[t0 = vgetq_lane_u32(vreinterpretq_u32_u64(II), 0)];
	op_flip  = COUNT_FLIP_X[vgetq_lane_u32(vreinterpretq_u32_u64(II), 2)];
	II = vreinterpretq_u64_s8(vnegq_s8(vreinterpretq_s8_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1])))));
	II = vpaddlq_u32(vmulq_u32(dmask, vreinterpretq_u32_u64(II)));
	op_flip += COUNT_FLIP_Y[vgetq_lane_u8(vreinterpretq_u8_u64(II), 3)];
	n_flips += (uint8_t) COUNT_FLIP_Y[t1 = vgetq_lane_u8(vreinterpretq_u8_u64(II), 11)];
  #endif
	n_flips += (uint8_t) op_flip;
	score += n_flips;

	if (n_flips == 0) {
		int score2 = score - 2;	// empty for opponent
		if (score <= 0)
			score = score2;

		if (score > alpha) {	// lazy cut-off
			// n_flips = last_flip(pos, O);
			m = o_mask[pos];	// valid diagonal bits
			n_flips  = op_flip >> 8;
			n_flips += (uint8_t) COUNT_FLIP_X[(t0 ^ m) & 0xFF];
			n_flips += (uint8_t) COUNT_FLIP_Y[t1 ^ (m >> 8)];

			if (n_flips != 0)
				score = score2 - n_flips;
		}
	}

	return score;
}

#else // simul COUNT_FLIP TLU

  #ifdef HAS_CPU_64
static const unsigned short cf_ofs_d[64][2] = {
	{    0, CF80 }, {    0, RF70 }, { CF82, RF60 }, { CF83, RF50 }, { CF84, RF40 }, { CF85, RF30 }, { CF86,    0 }, { CF87,    0 },
	{    0, CF81 }, {    0, CF81 }, { CF82, RF71 }, { CF83, RF61 }, { CF84, RF51 }, { CF85, RF41 }, { CF86,    0 }, { LF76,    0 },
	{ RF30, CF82 }, { RF41, CF82 }, { RF52, CF82 }, { RF63, RF72 }, { RF74, RF62 }, { CF85, RF52 }, { LF75, CF82 }, { LF65, CF82 },
	{ RF40, CF83 }, { RF51, CF83 }, { RF62, LF72 }, { RF73, CF83 }, { CF84, RF73 }, { LF74, RF63 }, { LF64, CF83 }, { LF54, CF83 },
	{ RF50, CF84 }, { RF61, CF84 }, { RF72, LF62 }, { CF83, LF73 }, { LF73, CF84 }, { LF63, RF74 }, { LF53, CF84 }, { LF43, CF84 },
	{ RF60, CF85 }, { RF71, CF85 }, { CF82, LF52 }, { LF72, LF63 }, { LF62, LF74 }, { LF52, CF85 }, { LF42, CF85 }, { LF32, CF85 },
	{ RF70,    0 }, { CF81,    0 }, { CF82, LF42 }, { CF83, LF53 }, { CF84, LF64 }, { CF85, LF75 }, {    0, CF86 }, {    0, CF86 },
	{ CF80,    0 }, { CF81,    0 }, { CF82, LF32 }, { CF83, LF43 }, { CF84, LF54 }, { CF85, LF65 }, {    0, LF76 }, {    0, CF87 }
};

  #else
static const uint32x4_t cf_ofs[64] = {
	{    0, CF80, CF80, CF80 }, {    0, CF80, CF81, RF70 }, { CF82, CF80, CF82, RF60 }, { CF83, CF80, CF83, RF50 }, 
	{ CF84, CF80, CF84, RF40 }, { CF85, CF80, CF85, RF30 }, { CF86, CF80, CF86,    0 }, { CF87, CF80, CF87,    0 }, 
	{    0, CF81, CF80, CF81 }, {    0, CF81, CF81, CF81 }, { CF82, CF81, CF82, RF71 }, { CF83, CF81, CF83, RF61 }, 
	{ CF84, CF81, CF84, RF51 }, { CF85, CF81, CF85, RF41 }, { CF86, CF81, CF86,    0 }, { LF76, CF81, CF87,    0 }, 
	{ RF30, CF82, CF80, CF82 }, { RF41, CF82, CF81, CF82 }, { RF52, CF82, CF82, CF82 }, { RF63, CF82, CF83, RF72 }, 
	{ RF74, CF82, CF84, RF62 }, { CF85, CF82, CF85, RF52 }, { LF75, CF82, CF86, CF82 }, { LF65, CF82, CF87, CF82 }, 
	{ RF40, CF83, CF80, CF83 }, { RF51, CF83, CF81, CF83 }, { RF62, CF83, CF82, LF72 }, { RF73, CF83, CF83, CF83 }, 
	{ CF84, CF83, CF84, RF73 }, { LF74, CF83, CF85, RF63 }, { LF64, CF83, CF86, CF83 }, { LF54, CF83, CF87, CF83 }, 
	{ RF50, CF84, CF80, CF84 }, { RF61, CF84, CF81, CF84 }, { RF72, CF84, CF82, LF62 }, { CF83, CF84, CF83, LF73 }, 
	{ LF73, CF84, CF84, CF84 }, { LF63, CF84, CF85, RF74 }, { LF53, CF84, CF86, CF84 }, { LF43, CF84, CF87, CF84 }, 
	{ RF60, CF85, CF80, CF85 }, { RF71, CF85, CF81, CF85 }, { CF82, CF85, CF82, LF52 }, { LF72, CF85, CF83, LF63 }, 
	{ LF62, CF85, CF84, LF74 }, { LF52, CF85, CF85, CF85 }, { LF42, CF85, CF86, CF85 }, { LF32, CF85, CF87, CF85 }, 
	{ RF70, CF86, CF80,    0 }, { CF81, CF86, CF81,    0 }, { CF82, CF86, CF82, LF42 }, { CF83, CF86, CF83, LF53 }, 
	{ CF84, CF86, CF84, LF64 }, { CF85, CF86, CF85, LF75 }, {    0, CF86, CF86, CF86 }, {    0, CF86, CF87, CF86 }, 
	{ CF80, CF87, CF80,    0 }, { CF81, CF87, CF81,    0 }, { CF82, CF87, CF82, LF32 }, { CF83, CF87, CF83, LF43 }, 
	{ CF84, CF87, CF84, LF54 }, { CF85, CF87, CF85, LF65 }, {    0, CF87, CF86, LF76 }, {    0, CF87, CF87, CF87 }  
};
  #endif

int mm_solve_exact_1(uint64x1_t P, int pos)
{
	uint_fast16_t op_flip;
	int p_flips, o_flips;
	int score = 2 * vaddv_u8(vcnt_u8(vreinterpret_u8_u64(P))) - 64 + 2;	// = (bit_count(P) + 1) - (SCORE_MAX - 1 - bit_count(P))
	uint64x2_t PP = vdupq_lane_u64(P, 0);
  #ifdef HAS_CPU_64	// vaddvq
	unsigned int t0, t1;
	const uint64x2_t dmask = { 0x0808040402020101, 0x8080404020201010 };
	uint64x2_t II;

	PP = vreinterpretq_u64_u8(vzip1q_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(PP)));
	t0 = vaddvq_u16(vreinterpretq_u16_u64(vandq_u64(PP, mask_dvhd[pos][0])));	// 2 dirs interleaved
	op_flip  = COUNT_FLIP[cf_ofs_d[pos][0] + (t0 & 0xFF)];
	op_flip += COUNT_FLIP[(pos & 0x07) * 256 + (t0 >> 8)];
	II = vandq_u64(vreinterpretq_u64_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1]))), dmask);
	t1 = vaddvq_u16(vreinterpretq_u16_u64(II));
	op_flip += COUNT_FLIP[((pos & 0x38) << 5) + (t1 & 0xFF)];
	op_flip += COUNT_FLIP[cf_ofs_d[pos][1] + (t1 >> 8)];

  #else // Neon kindergarten
	const uint32x4_t dmask = { 0x01020408, 0x10204080, 0x01020408, 0x10204080 };
	uint32x4_t cf_ofs_pos = cf_ofs[pos];
	uint32x4_t II;

	II = vreinterpretq_u32_u64(vpaddlq_u32(vpaddlq_u16(vpaddlq_u8(vreinterpretq_u8_u64(vandq_u64(PP, mask_dvhd[pos][0]))))));
	II = vaddq_u32(II, cf_ofs_pos);
	op_flip  = COUNT_FLIP[vgetq_lane_u32(II, 0)];
	op_flip += COUNT_FLIP[vgetq_lane_u32(II, 2)];
	II = vreinterpretq_u32_s8(vnegq_s8(vreinterpretq_s8_u8(vtstq_u8(vreinterpretq_u8_u64(PP), vreinterpretq_u8_u64(mask_dvhd[pos][1])))));
	II = vreinterpretq_u32_u64(vshlq_n_u64(vpaddlq_u32(vmulq_u32(dmask, II)), 8));	// 000000dd******00 000000vv******00
	II = vaddq_u32(II, cf_ofs_pos);
	op_flip += COUNT_FLIP[vgetq_lane_u32(II, 1)];
	op_flip += COUNT_FLIP[vgetq_lane_u32(II, 3)];
  #endif

	p_flips = op_flip & 0xFF;
	if (p_flips)
		return score + p_flips;

	o_flips = -(op_flip >> 8);
	return score + o_flips - (int)((o_flips | (score - 1)) < 0) * 2;	// last square for O if O can move or score <= 0
}
#endif
