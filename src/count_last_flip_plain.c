/**
 * @file count_last_flip_plain.c
 *
 *
 * A function is provided to count the number of fipped disc of the last move.
 *
 * The basic principle is to read into an array a precomputed result. Doing
 * this is easy for a single line ; as we can use arrays of the form:
 *  - COUNT_FLIP[square where we play][8-bits disc pattern].
 * The problem is thus to convert any line of a 64-bits disc pattern into an
 * 8-bits disc pattern. A fast way to do this is to select the right line,
 * with a bit-mask, to gather the masked-bits into a continuous set by a simple
 * multiplication and to right-shift the result to scale it into a number
 * between 0 and 255.
 * Once we get our 8-bits disc patterns, we directly get the number of
 * flipped discs from the precomputed array, and add them from each flipping
 * lines.
 * For optimization purpose, the value returned is twice the number of flipped
 * disc, to facilitate the computation of disc difference.
 *
 * @date 1998 - 2025
 * @author Richard Delorme
 * @author Toshihiko Okuhara
 * @version 4.6
 * 
 */

#include "bit.h"

/** precomputed count flip array */
/** lower byte for P, upper byte for O */
static const unsigned short COUNT_FLIP[] = {
	// CF80: 0
	0x0000, 0x0000, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0c00, 0x0c00,
	0x000c, 0x000c, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0200, 0x0200, 0x0002, 0x0002, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0200, 0x0200, 0x0002, 0x0002, 0x0000, 0x0000,
	// CF81: 256
	0x0000, 0x0000, 0x0000, 0x0000, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0800, 0x0800, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0008, 0x0008, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0a00, 0x0a00, 0x0a00, 0x0a00,
	0x000a, 0x000a, 0x000a, 0x000a, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0800, 0x0800, 0x0800, 0x0800,
	0x0008, 0x0008, 0x0008, 0x0008, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0000, 0x0000, 0x0000, 0x0000,
	// CF82: 512
	0x0000, 0x0002, 0x0200, 0x0000, 0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600, 0x0600, 0x0602, 0x0800, 0x0600,
	0x0006, 0x0008, 0x0206, 0x0006, 0x0006, 0x0008, 0x0206, 0x0006,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0800, 0x0802, 0x0a00, 0x0800, 0x0800, 0x0802, 0x0a00, 0x0800,
	0x0008, 0x000a, 0x0208, 0x0008, 0x0008, 0x000a, 0x0208, 0x0008,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600, 0x0600, 0x0602, 0x0800, 0x0600,
	0x0006, 0x0008, 0x0206, 0x0006, 0x0006, 0x0008, 0x0206, 0x0006,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400, 0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004, 0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200, 0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002, 0x0002, 0x0004, 0x0202, 0x0002,
	0x0000, 0x0002, 0x0200, 0x0000, 0x0000, 0x0002, 0x0200, 0x0000,
	// CF83: 768
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0600, 0x0604, 0x0602, 0x0602, 0x0800, 0x0800, 0x0a00, 0x0600,
	0x0600, 0x0604, 0x0602, 0x0602, 0x0800, 0x0800, 0x0a00, 0x0600,
	0x0006, 0x000a, 0x0008, 0x0008, 0x0206, 0x0206, 0x0406, 0x0006,
	0x0006, 0x000a, 0x0008, 0x0008, 0x0206, 0x0206, 0x0406, 0x0006,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0400, 0x0404, 0x0402, 0x0402, 0x0600, 0x0600, 0x0800, 0x0400,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0004, 0x0008, 0x0006, 0x0006, 0x0204, 0x0204, 0x0404, 0x0004,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0200, 0x0204, 0x0202, 0x0202, 0x0400, 0x0400, 0x0600, 0x0200,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0002, 0x0006, 0x0004, 0x0004, 0x0202, 0x0202, 0x0402, 0x0002,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	0x0000, 0x0004, 0x0002, 0x0002, 0x0200, 0x0200, 0x0400, 0x0000,
	// CF84: 1024
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0400, 0x0406, 0x0404, 0x0404, 0x0402, 0x0402, 0x0402, 0x0402,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0400,
	0x0400, 0x0406, 0x0404, 0x0404, 0x0402, 0x0402, 0x0402, 0x0402,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0400,
	0x0004, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0204, 0x0204, 0x0204, 0x0204, 0x0404, 0x0404, 0x0604, 0x0004,
	0x0004, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0204, 0x0204, 0x0204, 0x0204, 0x0404, 0x0404, 0x0604, 0x0004,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0200, 0x0206, 0x0204, 0x0204, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0200,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0002, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0402, 0x0402, 0x0602, 0x0002,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	0x0000, 0x0006, 0x0004, 0x0004, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0400, 0x0400, 0x0600, 0x0000,
	// CF85: 1280
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0200, 0x0208, 0x0206, 0x0206, 0x0204, 0x0204, 0x0204, 0x0204,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0200,
	0x0200, 0x0208, 0x0206, 0x0206, 0x0204, 0x0204, 0x0204, 0x0204,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0200,
	0x0002, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0402, 0x0402, 0x0402, 0x0402, 0x0602, 0x0602, 0x0802, 0x0002,
	0x0002, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202, 0x0202,
	0x0402, 0x0402, 0x0402, 0x0402, 0x0602, 0x0602, 0x0802, 0x0002,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	0x0000, 0x0008, 0x0006, 0x0006, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0600, 0x0600, 0x0800, 0x0000,
	// CF86: 1536
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	0x0000, 0x000a, 0x0008, 0x0008, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0800, 0x0800, 0x0a00, 0x0000,
	// CF87: 1792
	0x0000, 0x000c, 0x000a, 0x000a, 0x0008, 0x0008, 0x0008, 0x0008,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0800, 0x0800, 0x0800, 0x0800, 0x0a00, 0x0a00, 0x0c00, 0x0000,
	0x0000, 0x000c, 0x000a, 0x000a, 0x0008, 0x0008, 0x0008, 0x0008,
	0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006, 0x0006,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004, 0x0004,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400,
	0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600,
	0x0800, 0x0800, 0x0800, 0x0800, 0x0a00, 0x0a00, 0x0c00, 0x0000,

	// for shorter diagonal lines (interleaved), * = pos = 0
	// RF70: 2048 (.bbbbbb*)
	         // LF74: 2049 (bb*bbbb.)
	0x0000,  0x0000,      0x0200,  0x0006,      0x0002,  0x0004,      0x0400,  0x0004,
	0x0004,  0x0002,      0x0200,  0x0002,      0x0002,  0x0002,      0x0600,  0x0002,
	0x0006,  0x0200,      0x0200,  0x0200,      0x0002,  0x0200,      0x0400,  0x0200,
	0x0004,  0x0400,      0x0200,  0x0400,      0x0002,  0x0600,      0x0800,  0x0000,
	             // LF63: 2081 (bb*bbb..)                                          // LF41 (bb*0....)
	                                   // LF52: 2083 (bb*bb...)                    // LF30 (bb*.....)
	0x0008,      0x0000,  0x0200,      0x0000,  0x0002,      0x0004,  0x0400,      0x0000,
	0x0004,      0x0002,  0x0200,      0x0002,  0x0002,      0x0002,  0x0600,      0x0000,
	0x0006,      0x0200,  0x0200,      0x0200,  0x0002,      0x0200,  0x0400,      0x0000,
	0x0004,      0x0400,  0x0200,      0x0000,  0x0002,      0x0000,  0x0a00,      0,
	0x000a,  0x0200,      0x0200,  0x0206,      0x0002,  0x0204,      0x0400,  0x0204,
	0x0004,  0x0202,      0x0200,  0x0202,      0x0002,  0x0202,      0x0600,  0x0202,
	0x0006,  0x0400,      0x0200,  0x0400,      0x0002,  0x0400,      0x0400,  0x0400,
	0x0004,  0x0600,      0x0200,  0x0600,      0x0002,  0x0800,      0x0800,  0x0200,
	0x0008,      0x0200,  0x0200,      0x0200,  0x0002,      0x0204,  0x0400,      0x0200,
	0x0004,      0x0202,  0x0200,      0x0202,  0x0002,      0x0202,  0x0600,      0x0200,
	0x0006,      0x0400,  0x0200,      0x0400,  0x0002,      0x0400,  0x0400,      0x0200,
	0x0004,      0x0600,  0x0200,      0x0200,  0x0002,      0x0200,  0x0000,      0,
	// RF71: 2176 (.bbbbb*0)
	                      // RF61: 2178 (..bbbb*0)
	0x0000,  0x0002,      0x0000,  0x0008,      0x0200,  0x0006,      0x0200,  0x0006,
	0x0002,  0x0004,      0x0002,  0x0004,      0x0400,  0x0004,      0x0400,  0x0004,
	0x0004,  0x0202,      0x0004,  0x0202,      0x0200,  0x0202,      0x0200,  0x0202,
	0x0002,  0x0402,      0x0002,  0x0402,      0x0600,  0x0602,      0x0600,  0x0002,
	0x0006,      0x0002,  0x0006,      0x0002,  0x0200,      0x0006,  0x0200,      0x0002,
	0x0002,      0x0004,  0x0002,      0x0004,  0x0400,      0x0004,  0x0400,      0x0002,
	0x0004,      0x0202,  0x0004,      0x0202,  0x0200,      0x0202,  0x0200,      0x0002,
	0x0002,      0x0402,  0x0002,      0x0002,  0x0800,      0x0002,  0x0000,      0,
	                      // RF51: 2242 (...bbb*0)
	0x0008,  0x0000,      0x0000,  0x0006,      0x0200,  0x0004,      0x0200,  0x0004,
	0x0002,  0x0002,      0x0002,  0x0002,      0x0400,  0x0002,      0x0400,  0x0002,
	0x0004,  0x0200,      0x0004,  0x0200,      0x0200,  0x0200,      0x0200,  0x0200,
	0x0002,  0x0400,      0x0002,  0x0400,      0x0600,  0x0600,      0x0000,  0x0000,
	                      // RF41: 2274 (....bb*0)
	0x0006,      0x0000,  0x0000,      0x0000,  0x0200,      0x0004,  0x0200,      0x0000,
	0x0002,      0x0002,  0x0002,      0x0002,  0x0400,      0x0002,  0x0000,      0x0000,
	                      // RF31 (.....0*0)
	0x0004,      0x0200,  0x0000,      0x0200,  0x0200,      0x0200,  0x0000,      0x0000,
	0x0002,      0x0400,  0,           0x0000,  0x0000,      0x0000,  0,           0,

	// RF60: 2304 (..bbbbb*)
	         // RF50: 2305 (...bbbb*)
	0x0000,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0600,  0x0600,
	0x0006,  0x0006,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0800,  0x0000,
	         // RF40: 2337 (....bbb*)
	0x0008,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0400,
	0x0004,  0x0004,  0x0200,  0x0200,  0x0002,  0x0002,  0x0600,  0x0000,
	         // RF30: 2353 (.....bb*)
	0x0006,  0x0000,  0x0200,  0x0200,  0x0002,  0x0002,  0x0400,  0x0000,
	0x0004,  0,       0x0200,  0,       0x0002,  0,       0x0000,  0,

	// RF72: 2368 (.bbbb*bb)         // RF62: 2372 (..bbb*bb)
	0x0000, 0x0002, 0x0200, 0x0000,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400,  0x0400, 0x0402, 0x0600, 0x0400,
	0x0004, 0x0006, 0x0204, 0x0004,  0x0004, 0x0006, 0x0204, 0x0004,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0600, 0x0602, 0x0800, 0x0600,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF52: 2436 (...bb*bb)
	0x0006, 0x0008, 0x0206, 0x0006,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0200, 0x0202, 0x0400, 0x0200,
	0x0002, 0x0004, 0x0202, 0x0002,  0x0002, 0x0004, 0x0202, 0x0002,
	0x0400, 0x0402, 0x0600, 0x0400,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF42 (....0*bb)
	0x0004, 0x0006, 0x0204, 0x0004,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0200, 0x0202, 0x0400, 0x0200,  0x0000, 0x0002, 0x0200, 0x0000,
	                                 // RF32 (.....*bb)
	0x0002, 0x0004, 0x0202, 0x0002,  0x0000, 0x0002, 0x0200, 0x0000,
	0x0000, 0x0002, 0x0200, 0x0000,  0, 0, 0, 0,

	// LF72: 2496 (bbbb*bb.)
	         // LF61 (bbbb*0..)
	                           // LF50 (bbbb*...)
	0x0000,  0x0000,  0x0002,  0x0000,  0x0200,  0x0000,  0x0000,  0,
	    // RF73: 2504 (.bbb*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0400,  0x0400,  0x0402,  0x0400,  0x0600,  0x0400,  0x0400,  0,
	    0x0400,  0x0404,  0x0402,  0x0402,  0x0600,  0x0600,  0x0800,  0x0400,
	0x0004,  0x0004,  0x0006,  0x0004,  0x0204,  0x0004,  0x0004,  0,
	    0x0004,  0x0008,  0x0006,  0x0006,  0x0204,  0x0204,  0x0404,  0x0004,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0600,  0x0600,  0x0602,  0x0600,  0x0800,  0x0600,  0x0600,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0006,  0x0006,  0x0008,  0x0006,  0x0206,  0x0006,  0x0006,  0,
	    // RF63: 2632 (..bb*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0200,  0x0204,  0x0202,  0x0202,  0x0400,  0x0400,  0x0600,  0x0200,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    0x0002,  0x0006,  0x0004,  0x0004,  0x0202,  0x0202,  0x0402,  0x0002,
	0x0400,  0x0400,  0x0402,  0x0400,  0x0600,  0x0400,  0x0400,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0004,  0x0004,  0x0006,  0x0004,  0x0204,  0x0004,  0x0004,  0,
	    // RF53 (...0*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0200,  0x0200,  0x0202,  0x0200,  0x0400,  0x0200,  0x0200,  0,
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0002,  0x0002,  0x0004,  0x0002,  0x0202,  0x0002,  0x0002,  0,
	    // RF43 (....*bbb)
	    0x0000,  0x0004,  0x0002,  0x0002,  0x0200,  0x0200,  0x0400,  0x0000,
	0x0000,  0x0000,  0x0002,  0x0000,  0x0200,  0x0000,  0x0000,  0,

	// LF73: 2744 (bbb*bbb.)
	         // LF62: 2745 (bbb*bb..)
	                           // LF51 (bbb*0...)                  // LF40 (bbb*....)
	0x0000,  0x0000,  0x0004,  0x0000,  0x0002,  0x0002,  0x0002,  0x0000,
	0x0200,  0x0200,  0x0200,  0x0000,  0x0400,  0x0000,  0x0000,  0,
	    // RF74: 2760 (.bb*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0200,  0x0200,  0x0204,  0x0200,  0x0202,  0x0202,  0x0202,  0x0200,
	0x0400,  0x0400,  0x0400,  0x0200,  0x0600,  0x0200,  0x0200,  0,
	    0x0200,  0x0206,  0x0204,  0x0204,  0x0202,  0x0202,  0x0202,  0x0202,
	    0x0400,  0x0400,  0x0400,  0x0400,  0x0600,  0x0600,  0x0800,  0x0200,
	0x0002,  0x0002,  0x0006,  0x0002,  0x0004,  0x0004,  0x0004,  0x0002,
	0x0202,  0x0202,  0x0202,  0x0002,  0x0402,  0x0002,  0x0002,  0,
	    0x0002,  0x0008,  0x0006,  0x0006,  0x0004,  0x0004,  0x0004,  0x0004,
	    0x0202,  0x0202,  0x0202,  0x0202,  0x0402,  0x0402,  0x0602,  0x0002,
	0x0400,  0x0400,  0x0404,  0x0400,  0x0402,  0x0402,  0x0402,  0x0400,
	0x0600,  0x0600,  0x0600,  0x0400,  0x0800,  0x0400,  0x0400,  0,
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0004,  0x0004,  0x0008,  0x0004,  0x0006,  0x0006,  0x0006,  0x0004,
	0x0204,  0x0204,  0x0204,  0x0004,  0x0404,  0x0004,  0x0004,  0,
	    // RF64 (...0*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0200,  0x0200,  0x0204,  0x0200,  0x0202,  0x0202,  0x0202,  0x0200,
	0x0400,  0x0400,  0x0400,  0x0200,  0x0600,  0x0200,  0x0200,  0,
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0002,  0x0002,  0x0006,  0x0002,  0x0004,  0x0004,  0x0004,  0x0002,
	0x0202,  0x0202,  0x0202,  0x0002,  0x0402,  0x0002,  0x0002,  0,
	    // RF54 (....*bbbb)
	    0x0000,  0x0006,  0x0004,  0x0004,  0x0002,  0x0002,  0x0002,  0x0002,
	    0x0200,  0x0200,  0x0200,  0x0200,  0x0400,  0x0400,  0x0600,  0x0000,
	0x0000,  0x0000,  0x0004,  0x0000,  0x0002,  0x0002,  0x0002,  0x0000,
	0x0200,  0x0200,  0x0200,  0x0000,  0x0400,  0x0000,  0x0000,  0,

	// LF75: 2984 (0*bbbbb.)
	         // LF64: 2985 (0*bbbb..)                              // LF42: 2991 (0*bb....)
	                           // LF53:2987 (0*bbb...)             // LF31 (0*0.....)
	0x0000,  0x0000,  0x0008,  0x0000,  0x0006,  0x0006,  0x0006,  0x0000,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0000,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0000,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0000,
	0x0600,  0x0600,  0x0600,  0x0000,  0x0800,  0x0000,  0x0000,  0,

	// LF76: 3048 (*bbbbbb.)
	         // LF65: 3049 (*bbbbb..)                              // LF43: 3055 (*bbb....)
	                           // LF54: 3051 (*bbbb...)            // LF32: 3063 (*bb.....)
	0x0000,  0x0000,  0x000a,  0x0000,  0x0008,  0x0008,  0x0008,  0x0000,
	0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0006,  0x0000,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,
	0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0x0004,  0,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,
	0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0x0002,  0,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,
	0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0x0200,  0,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,
	0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0400,  0x0000,
	0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0600,  0x0000,
	0x0800,  0x0800,  0x0800,  0x0000,  0x0a00,  0x0000,  0x0000,  0,
};	// 3176

enum {
	CF80 =    0, CF81 =  256, CF82 =  512, CF83 =  768, CF84 = 1024, CF85 = 1280, CF86 = 1536, CF87 = 1792,
	RF70 = 2048, RF71 = 2176, RF72 = 2368, RF73 = 2504, RF74 = 2760,
	RF60 = 2304, RF61 = 2178, RF62 = 2372, RF63 = 2632,
	RF50 = 2305, RF51 = 2242, RF52 = 2436,
	RF40 = 2337, RF41 = 2274,
	RF30 = 2353,
	LF72 = 2496, LF73 = 2744, LF74 = 2049, LF75 = 2984, LF76 = 3048,
	LF62 = 2745, LF63 = 2081, LF64 = 2985, LF65 = 3049,
	LF52 = 2083, LF53 = 2987, LF54 = 3051,
	LF42 = 2991, LF43 = 3055,
	LF32 = 3063
};

static const unsigned short cf_ofs_d[64][2] = {
	{    0, CF80 }, {    0, CF81 }, { CF82, CF82 }, { CF83, CF83 }, { CF84, CF84 }, { CF85, CF85 }, { CF86,    0 }, { CF87,    0 },
	{    0, RF70 }, {    0, CF81 }, { CF82, CF82 }, { CF83, CF83 }, { CF84, CF84 }, { CF85, CF85 }, { CF86,    0 }, { LF76,    0 },
	{ RF30, RF60 }, { RF41, RF71 }, { RF52, CF82 }, { RF63, LF72 }, { RF74, LF62 }, { CF85, LF52 }, { LF75, LF42 }, { LF65, LF32 },
	{ RF40, RF50 }, { RF51, RF61 }, { RF62, RF72 }, { RF73, CF83 }, { CF84, LF73 }, { LF74, LF63 }, { LF64, LF53 }, { LF54, LF43 },
	{ RF50, RF40 }, { RF61, RF51 }, { RF72, RF62 }, { CF83, RF73 }, { LF73, CF84 }, { LF63, LF74 }, { LF53, LF64 }, { LF43, LF54 },
	{ RF60, RF30 }, { RF71, RF41 }, { CF82, RF52 }, { LF72, RF63 }, { LF62, RF74 }, { LF52, CF85 }, { LF42, LF75 }, { LF32, LF65 },
	{ RF70,    0 }, { CF81,    0 }, { CF82, CF82 }, { CF83, CF83 }, { CF84, CF84 }, { CF85, CF85 }, {    0, CF86 }, {    0, LF76 },
	{ CF80,    0 }, { CF81,    0 }, { CF82, CF82 }, { CF83, CF83 }, { CF84, CF84 }, { CF85, CF85 }, {    0, CF86 }, {    0, CF87 }
};

/* bit masks for diagonal lines */
static const unsigned long long mask_d[2][64] = {{
	0x0000000000000000, 0x0000000000000000, 0x0000000000010200, 0x0000000001020400,
	0x0000000102040800, 0x0000010204081000, 0x0001020408102000, 0x0102040810204080,
	0x0000000000000000, 0x0000000000000000, 0x0000000001020000, 0x0000000102040000,
	0x0000010204080000, 0x0001020408100000, 0x0102040810204080, 0x0204081020400000,
	0x0000000000000204, 0x0000000000000408, 0x0000000102000810, 0x0000010204001020,
	0x0001020408002040, 0x0102040810204080, 0x0204081020000000, 0x0408102040000000,
	0x0000000000020408, 0x0000000000040810, 0x0000010200081020, 0x0001020400102040,
	0x0102040810204080, 0x0204081000408000, 0x0408102000000000, 0x0810204000000000,
	0x0000000002040810, 0x0000000004081020, 0x0001020008102040, 0x0102040810204080,
	0x0204080020408000, 0x0408100040800000, 0x0810200000000000, 0x1020400000000000,
	0x0000000204081020, 0x0000000408102040, 0x0102040810204080, 0x0204001020408000,
	0x0408002040800000, 0x0810004080000000, 0x1020000000000000, 0x2040000000000000,
	0x0000020408102040, 0x0102040810204080, 0x0000081020408000, 0x0000102040800000,
	0x0000204080000000, 0x0000408000000000, 0x0000000000000000, 0x0000000000000000,
	0x0102040810204080, 0x0004081020408000, 0x0008102040800000, 0x0010204080000000,
	0x0020408000000000, 0x0040800000000000, 0x0000000000000000, 0x0000000000000000
}, {
	0x8040201008040201, 0x0080402010080400, 0x0000804020100800, 0x0000008040201000,
	0x0000000080402000, 0x0000000000804000, 0x0000000000000000, 0x0000000000000000,
	0x4020100804020000, 0x8040201008040201, 0x0080402010080000, 0x0000804020100000,
	0x0000008040200000, 0x0000000080400000, 0x0000000000000000, 0x0000000000000000,
	0x2010080402000000, 0x4020100804000000, 0x8040201008040201, 0x0080402010000402,
	0x0000804020000804, 0x0000008040001008, 0x0000000000002010, 0x0000000000004020,
	0x1008040200000000, 0x2010080400000000, 0x4020100800020100, 0x8040201008040201,
	0x0080402000080402, 0x0000804000100804, 0x0000000000201008, 0x0000000000402010,
	0x0804020000000000, 0x1008040000000000, 0x2010080002010000, 0x4020100004020100,
	0x8040201008040201, 0x0080400010080402, 0x0000000020100804, 0x0000000040201008,
	0x0402000000000000, 0x0804000000000000, 0x1008000201000000, 0x2010000402010000,
	0x4020000804020100, 0x8040201008040201, 0x0000002010080402, 0x0000004020100804,
	0x0000000000000000, 0x0000000000000000, 0x0000020100000000, 0x0000040201000000,
	0x0000080402010000, 0x0000100804020100, 0x8040201008040201, 0x0000402010080402,
	0x0000000000000000, 0x0000000000000000, 0x0002010000000000, 0x0004020100000000,
	0x0008040201000000, 0x0010080402010000, 0x0020100804020100, 0x8040201008040201
}};

#ifdef HAS_CPU_64
#define	packV(P, x)	(((((P) >> (x)) & 0x0101010101010101ULL) * 0x0102040810204080ULL) >> 56)
#define packD(PM)	(((PM) * 0x0101010101010101ULL) >> 56)
#else
#define	packV(P, x)	(((((((unsigned int)(P)) >> (x)) & 0x01010101u) + (((((unsigned int)((P) >> 32)) >> (x)) & 0x01010101u) << 4)) * 0x01020408u) >> 24)
#define	packD(PM)	(((((unsigned int)(PM)) * 0x01010101u) + (((unsigned int)((PM) >> 32)) * 0x01010101u)) >> 24)
#endif // HAS_CPU_64

/**
 * Count last flipped discs when playing on the last empty.
 *
 * @param pos the last empty square.
 * @param P player's disc pattern.
 * @return flipped disc count.
 */
int last_flip(int pos, unsigned long long P)
{
	unsigned long long PM;
	int n_flips;
	int x = pos & 0x07;
	int y8 = pos & 0x38;
	const unsigned short *COUNT_FLIP_X = COUNT_FLIP + x * 256;

	n_flips  = (unsigned char) COUNT_FLIP[y8 * 32 + packV(P, x)];
	n_flips += (unsigned char) COUNT_FLIP_X[(P >> y8) & 0xFF];
	PM = P & mask_d[0][pos];
	n_flips += (unsigned char) COUNT_FLIP_X[packD(PM)];
	PM = P & mask_d[1][pos];
	n_flips += (unsigned char) COUNT_FLIP_X[packD(PM)];

	return n_flips;
}

/**
 * @brief Get the final score.
 *
 * Get the final score, when 1 empty square remain.
 * The following code has been adapted from Zebra by Gunnar Anderson.
 *
 * @param player Board.player to evaluate.
 * @param alpha  Alpha bound. (beta - 1)
 * @param x      Last empty square to play.
 * @return       The final score, as a disc difference.
 */
int board_score_1(const unsigned long long P, const int alpha, const int pos)
{
	unsigned long long PM;
	int op_flip, p_flips, o_flips;
	int x = pos & 0x07;
	int y8 = pos & 0x38;
	int score = 2 * bit_count(P) - 64 + 2;	// = (bit_count(P) + 1) - (SCORE_MAX - 1 - bit_count(P))

	op_flip  = COUNT_FLIP[y8 * 32 + packV(P, x)];
	op_flip += COUNT_FLIP[x * 256 + ((P >> y8) & 0xFF)];
	PM = P & mask_d[0][pos];
	op_flip += COUNT_FLIP[cf_ofs_d[pos][0] + packD(PM)];
	PM = P & mask_d[1][pos];
	op_flip += COUNT_FLIP[cf_ofs_d[pos][1] + packD(PM)];

	p_flips = op_flip & 0xFF;
	if (p_flips)
		return score + p_flips;

	o_flips = -(op_flip >> 8);
	(void) alpha;	// no lazy cut-off
	return score + o_flips - (int)((o_flips | (score - 1)) < 0) * 2;	// last square for O if O can move or score <= 0
}
